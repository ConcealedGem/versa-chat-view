# 文件预览功能演示说明

## 功能更新

现在已经实现了**真实文件内容解析**功能！不再是模拟数据，而是能够读取和解析您上传的真实文件内容。

## 支持的功能

### ✅ Excel文件 (.xlsx, .xls)
- **真实解析**：使用SheetJS库直接读取Excel文件内容
- **显示实际数据**：表格、数据、工作表名称等
- **多工作表支持**：显示第一个工作表的内容
- **样式优化**：表头高亮显示

### ✅ Word文档 (.docx)  
- **真实解析**：使用mammoth.js库转换Word文档
- **HTML渲染**：保持文档格式和样式
- **文本提取**：支持段落、列表、格式等

### ⚠️ PDF文件 (.pdf)
- **部分支持**：使用PDF.js库提取文本内容
- **文本显示**：显示PDF中的文本内容（最多5页）
- **浏览器限制**：PDF渲染在某些环境下可能受限

## 使用方法

### 1. 测试Excel文件
1. 创建一个简单的Excel文件（.xlsx格式）
2. 添加一些数据，比如：
   ```
   姓名    年龄    部门
   张三    25     技术部
   李四    30     市场部
   ```
3. 在聊天界面上传此文件
4. 右侧Canvas区域会自动显示解析后的表格内容

### 2. 测试Word文档
1. 创建一个Word文档（.docx格式）
2. 添加一些内容：标题、段落、列表等
3. 上传文件后在Canvas区域查看HTML格式的预览

### 3. 测试PDF文件
1. 准备任意PDF文件
2. 上传后查看提取的文本内容

## 技术特点

### 前端直接解析
- **无需后端**：所有文件解析都在浏览器中完成
- **实时预览**：上传后立即解析和显示
- **隐私保护**：文件不会发送到服务器进行解析

### 缓存机制
- 解析结果会被缓存，避免重复处理
- 本地解析的文件带有"本地解析"标识

### 错误处理
- 文件解析失败时会显示友好的错误提示
- 不支持的文件类型会回退到模拟数据

## 开发者注意事项

### 库依赖
```bash
npm install xlsx mammoth pdfjs-dist
```

### 代码结构
```
src/lib/services/
├── file-parser-service.ts     # 真实文件解析服务
├── file-preview-service.ts    # 模拟数据服务（作为回退）
└── canvas-service.ts          # Canvas显示服务

src/components/
├── file-preview-viewer.tsx    # 支持真实内容预览
└── chat-panel.tsx            # 集成文件解析
```

### 性能考虑
- 文件大小限制：2MB
- PDF解析限制：最多5页
- Excel大表格可能影响渲染性能

## 测试步骤

1. **启动服务**：`npm run dev`
2. **打开浏览器**：访问 http://localhost:3000
3. **上传真实文件**：
   - 准备一个小的Excel文件（包含实际数据）
   - 在聊天输入框点击文件上传按钮
   - 选择并上传Excel文件
4. **查看结果**：
   - 右侧Canvas区域会显示"本地解析"标识
   - 表格中会显示您Excel文件的真实数据
   - 而不是之前的模拟数据

## 效果对比

### 之前（模拟数据）
```
姓名    年龄    部门    薪资
张三    25     技术部   8000
李四    30     市场部   7500
```

### 现在（真实数据）
显示您上传Excel文件中的实际内容！

这是一个重大突破，从模拟数据转向真实文件内容解析，大大提升了用户体验！ 